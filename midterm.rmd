---
title: "CPLN 675 Midterm"
author: "Marquise Williams and Will Friedrichs"
date: "3/29/2022"
output: 
  html_document:
    code_folding: hide
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    runtime: shiny
---

For this project, a generalized linear model will be used to predict flood inundation zones first in Calgary, then in Sacramento County. For each area, predictions will estimate whether or not a given 500m by 500m "cell" of area can be described as in a flood inundation zone. This prediction process is described in four steps: data gathering, building variables, logistic metrics, and goodness of fit metrics.

```{r setup, include=TRUE,message = FALSE,cache=TRUE}
knitr::opts_chunk$set(echo = TRUE)
sf::sf_use_s2(FALSE)
options(scipen=999)
library(caret)
library(pscl)
library(plotROC)
library(pROC)
library(sf)
library(tidyverse)
library(knitr)
library(kableExtra)
library(tigris)
library(viridis)
```


### 1) Data Gathering

The following factors will be examined as predictors of Calgary's flood inundation zones.

<code>cal_dem</code>, <code>sac_dem</code>: For Calgary and Sacramento County respectively, <code>cal_dem</code> and <code>sac_dem</code> represent elevation data relative to the lowest point in the area. Flood inundation is probably more likely in low-lying areas than high elevation areas, so there is reason to suspect this factor might be significant.

<code>cal_streamdist</code>, <code>sac_streamdist</code>: For Calgary and Sacramento County respectively, <code>cal_dem</code> and <code>sac_dem</code> describe the distance between any cell and a stream. This is due to our hypothesis that areas with streams have a higher flooding suceptibility. 

NEED LAND USE, NEED TREE COVER, NEED DISTANCE TO RIVER AS ADDITIONAL FACTORS HERE

<code>cal_inundation</code>: This is what our model aims to predict. We will train our model on part of Calgary flood inundation fishnet, and test our predictions on another part of it.


```{r load_chesco, warning = FALSE, message = FALSE}
cal_dem <- st_read("https://raw.githubusercontent.com/Willfriedrichs/Midterm_Repo/main/Finalized_Layers/Cal_dem_filled.json")

cal_streamdist <- st_read("https://raw.githubusercontent.com/Willfriedrichs/Midterm_Repo/main/Finalized_Layers/cal_dist2streams.json")

cal_inundation <- st_read("https://raw.githubusercontent.com/Willfriedrichs/Midterm_Repo/main/Finalized_Layers/calgary_inundation.json")

cal_inundation[is.na(cal_inundation)] = 0

sac_dem <- st_read("https://raw.githubusercontent.com/Willfriedrichs/Midterm_Repo/main/Finalized_Layers/sac_dem_filled.geojson")

sac_streamdist <- st_read("https://raw.githubusercontent.com/Willfriedrichs/Midterm_Repo/main/Finalized_Layers/sac_dist2streams.geojson")

ggplot() +
  geom_sf(data=cal_inundation, aes(fill=as.factor(calgary_inundation.MAJORITY))) +
  labs(title="cal_inundation")
```


### 2) Building Variables

#MAKE CHANGES TO VARIABLES HERE: E.G. MAKE SURE ELEVATION IS RELATIVE (subtract the minimum elevation from all values)

### 3) logistic metrics


### 4) Goodness of fit metrics


