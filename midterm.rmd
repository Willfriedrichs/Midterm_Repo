---
  title: "CPLN 675: Interpolating Air Pollution Dynamics with Interpolation and Regression"
author: "Marquise Williams and Will Friedrichs"
date: "2/21/2022"
output:
  html_document:
  toc: true
toc_float: true
code_folding: hide
code_download: true
---
  
  ```{r setup, include=FALSE,message = FALSE,cache=TRUE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen=999)
library(knitr)
```


# Creating Our Fishnet in R



The `sf` package offers really easy way to create fishnet grids - `st_make_grid`.

Let's load a spatial data file and make our very own. Remember our data from Chester County in Week 2? Let's load our Chester County municipalities file, then use `st_union` to go from a bunch of polygons to just one (e.g. the boundary).

```{r load_chesco, warning = FALSE, message = FALSE}
chesterBoundary <- read_sf("https://raw.githubusercontent.com/mafichman/CPLN_675/main/Week_2/data/R_Data/Chester_MuniBoundaries.geojson") %>%
  st_union()

```

Not sure what the projection is? It's important to know - the cellsize you set for your fishnet will be in the native units of the projection. Check `st_crs(chesterBoundary)` to find out, and `st_transform` to the projection you need if necessary.

Here we are our CRS is 2272 (PA State Plane, linear unit = feet), so we're OK. We set the `cellsize = 10000` - 10,000 feet per cell.

Examine the fishnet - the unique ID is crucial to building a data set!

```{r make_fishnet}

fishnet <- 
  st_make_grid(chesterBoundary,
               cellsize = 10000, 
               square = TRUE) %>%
  .[chesterBoundary] %>%            # clips the grid to the chesterBoundary file
  st_sf() %>%
  mutate(uniqueID = rownames(.))
```


Voila, now you have a fishnet you can use for your analysis. Let's take a quick look at it and add the `chesterBoundary` for some context.

```{r plot_fishnet}

ggplot()+
  geom_sf(data = fishnet)+
  geom_sf(data = chesterBoundary, 
          color = "red", fill = "transparent")

```
